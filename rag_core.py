<rag_core.py content from previous message>